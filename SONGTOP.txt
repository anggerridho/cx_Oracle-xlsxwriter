SELECT CALLING_DATE,
       RANK,
       CONTENT_SINGER,
       CONTENT_TITLE,
       TRAFFIC,
       REVENUE,
       CP_NAME
  FROM (  SELECT a.calling_date,
                 a.rating_content_id,
                 SUM (a.total_success) AS traffic,
                 SUM (a.total_revenue) AS revenue,
                 b.promo_code AS content_title,
                 b.content_singer AS content_singer,
                 c.mcp_user_disp_name AS cp_name,
                 RANK ()
                    OVER (PARTITION BY calling_date
                          ORDER BY SUM (a.total_revenue) DESC)
                    RANK
            FROM CDR_ACTIVATION_SUMMARY_DAY a, tot_content b, mcp_user_info c
           WHERE     CALLING_DATE = TO_CHAR(SYSDATE-1,'YYYYMMDD')
                 AND a.rating_content_id = b.content_id
                 AND c.mcp_user_id = b.mcp_user_id
        GROUP BY a.rating_content_id,
                 promo_code,
                 content_singer,
                 mcp_user_disp_name,
                 a.calling_date
        ORDER BY 1, revenue DESC)
 WHERE RANK BETWEEN 1 AND 75
